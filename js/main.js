/*! echo-js v1.7.3 | (c) 2016 @toddmotto | https://github.com/toddmotto/echo */
(function(e,t){if(typeof define==="function"&&define.amd){define((function(){return t(e)}))}else if(typeof exports==="object"){module.exports=t}else{e.echo=t(e)}})(this,(function(e){"use strict";var t={};var n=function(){};var o,r,i,a,c;var l=function(e){return e.offsetParent===null};var d=function(e,t){if(l(e)){return false}var n=e.getBoundingClientRect();return n.right>=t.l&&n.bottom>=t.t&&n.left<=t.r&&n.top<=t.b};var u=function(){if(!a&&!!r){return}clearTimeout(r);r=setTimeout((function(){t.render();r=null}),i)};t.init=function(r){r=r||{};var l=r.offset||0;var d=r.offsetVertical||l;var s=r.offsetHorizontal||l;var m=function(e,t){return parseInt(e||t,10)};o={t:m(r.offsetTop,d),b:m(r.offsetBottom,d),l:m(r.offsetLeft,s),r:m(r.offsetRight,s)};i=m(r.throttle,250);a=r.debounce!==false;c=!!r.unload;n=r.callback||n;t.render();if(document.addEventListener){e.addEventListener("scroll",u,false);e.addEventListener("load",u,false)}else{e.attachEvent("onscroll",u);e.attachEvent("onload",u)}};t.render=function(){var r=document.querySelectorAll("img[data-echo], [data-echo-background]");var i=r.length;var a,l;var u={l:0-o.l,t:0-o.t,b:(e.innerHeight||document.documentElement.clientHeight)+o.b,r:(e.innerWidth||document.documentElement.clientWidth)+o.r};for(var s=0;s<i;s++){l=r[s];if(d(l,u)){if(c){l.setAttribute("data-echo-placeholder",l.src)}if(l.getAttribute("data-echo-background")!==null){l.style.backgroundImage="url("+l.getAttribute("data-echo-background")+")"}else{l.src=l.getAttribute("data-echo")}if(!c){l.removeAttribute("data-echo");l.removeAttribute("data-echo-background")}n(l,"load")}else if(c&&!!(a=l.getAttribute("data-echo-placeholder"))){if(l.getAttribute("data-echo-background")!==null){l.style.backgroundImage="url("+a+")"}else{l.src=a}l.removeAttribute("data-echo-placeholder");n(l,"unload")}}if(!i){t.detach()}};t.detach=function(){if(document.removeEventListener){e.removeEventListener("scroll",u)}else{e.detachEvent("onscroll",u)}clearTimeout(r)};return t}));function deepCopy(e,t){var e=e||{};for(var n in t){if(typeof t[n]==="object"){e[n]=t[n].constructor===Array?[]:{};deepCopy(t[n],e[n])}else{e[n]=t[n]}}return e}var JELON=window.JELON||{};JELON=deepCopy(JELON,{name:"JELON",version:"0.0.2",init:function(){this.toggleMenu();this.backToTop();echo.init({offset:50,throttle:250,unload:false,callback:function(e,t){console.log(e,"has been",t+"ed")}});this.initSearch();this.initImgPreviewer()},$:function(e){return/^(\[object HTML)[a-zA-Z]*(Element\])$/.test(Object.prototype.toString.call(e))?e:document.getElementById(e)},toggleMenu:function(){var e=this,t=e.$(e.name+"__menu");e.$(e.name+"__btnDropNav").onclick=function(){if(t.className.indexOf("hidden")===-1){t.className+=" hidden"}else{t.className=t.className.replace(/\s*hidden\s*/,"")}}},backToTop:function(){var e=this;if(typeof e.$(e.name+"__backToTop")==="undefined")return;window.onscroll=window.onresize=function(){if(document.documentElement.scrollTop+document.body.scrollTop>0){e.$(e.name+"__backToTop").style.display="block"}else{e.$(e.name+"__backToTop").style.display="none"}};e.$(e.name+"__backToTop").onclick=function(){var e=setInterval(t,10);function t(){if(document.documentElement.scrollTop+document.body.scrollTop<1){clearInterval(e)}else{document.documentElement.scrollTop/=1.1;document.body.scrollTop/=1.1}}}},initSearch:function(){var e=this;if(document.getElementById("searchKeyword")&&document.getElementById("searchButton")){document.getElementById("searchKeyword").onkeyup=function(t){var t=t||window.event;var n=t.keyCode||t.which||t.key;if(n===13){e.startSearch()}};document.getElementById("searchButton").onclick=e.startSearch}},startSearch:function(){if(document.getElementById("searchKeyword").value){document.getElementById("searchKeywordHidden").value="site:jelon.info "+document.getElementById("searchKeyword").value;document.getElementById("searchForm").submit()}},initImgPreviewer:function(){var e=this;var t=document.getElementById(e.name+"__articlePostContent");var n=t&&t.getElementsByTagName("img");if(t&&n.length){t.addEventListener("click",(function(t){e.handleImgPreview(t)}),false)}},handleImgPreview:function(e){var t=e.target;if(t.nodeName.toUpperCase()==="IMG"){this.createImgPreviewer(t.src);this.onRemoveImgPreviewer()}},createImgPreviewer:function(e){var t=document.createElement("div");var n=document.createElement("img");t.id=this.name+"__imgPreviewer";t.style=["position: fixed","display: flex","top: 0","right: 0","bottom: 0","left: 0","width: 100%","height: 100%","align-items: center","background-color: rgba(30, 30, 30, .9)","transition-duration: inherit","transition-property: opacity","transition-timing-function: cubic-bezier(.47,0,.74,.71)","z-index: 10000"].join(";");n.src=e;n.alt="预览";n.style=["margin: 0 auto","max-width: 80%","max-height: 80%","transform: scale(1, 1)","z-index: 10001"].join(";");t.appendChild(n);document.body.appendChild(t)},onRemoveImgPreviewer:function(){var e=document.getElementById(this.name+"__imgPreviewer");if(e){e.onclick=function(){document.body.removeChild(e)}}}});JELON.init();